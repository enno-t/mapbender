
{{ form_row(form.configuration.advanced) }}
<hr>
<h3 class="my-4">Element</h3>
{{ form_row(form.title) }}

<div class="mb-3">
    {{ form_widget(form.configuration.autoSubmit, {'label_attr': {'class': 'checkbox-inline'}}) }}
    {{ form_widget(form.configuration.addIntermediatePoints, {'label_attr': {'class': 'checkbox-inline'}}) }}
    {{ form_widget(form.configuration.disableContextMenu, {'label_attr': {'class': 'checkbox-inline'}}) }}
</div>
<div class="mb-3">
    {{ form_widget(form.configuration.addSearch, {'label_attr': {'class': 'checkbox-inline'}}) }}
    {{ form_widget(form.configuration.addReverseGeocoding, {'label_attr': {'class': 'checkbox-inline'}}) }}
</div>

{{ form_row(form.configuration.buffer) }}
{{ form_row(form.configuration.color) }}
{{ form_row(form.configuration.width) }}
{{ form_row(form.configuration.opacity) }}

<div class="basic advanced d-none">
    {{ form_row(form.configuration.infoText) }}
    {{ form_row(form.configuration.dateTimeFormat) }}
    {{ form_row(form.configuration.startImagePath) }}
    {{ form_row(form.configuration.startImageSize) }}
    {{ form_row(form.configuration.startImageOffset) }}
    {{ form_row(form.configuration.intermediateImagePath) }}
    {{ form_row(form.configuration.intermediateImageSize) }}
    {{ form_row(form.configuration.intermediateImageOffset) }}
    {{ form_row(form.configuration.destinationImagePath) }}
    {{ form_row(form.configuration.destinationImageSize) }}
    {{ form_row(form.configuration.destinationImageOffset) }}
</div>
<hr>
<h3 class="my-4">Routingsoftware</h3>
{{ form_row(form.configuration.routingDriver) }}

<div class="graphhopper drivers d-none">
    {{ form_row(form.configuration.ghUrl) }}
    {{ form_row(form.configuration.ghTransportationMode) }}
    {{ form_row(form.configuration.ghKey) }}
    <div class="advanced d-none">
        {{ form_row(form.configuration.ghWeighting) }}
        {{ form_row(form.configuration.ghOptimize) }}
        {{ form_row(form.configuration.ghElevation) }}
        {{ form_row(form.configuration.ghInstructions) }}
    </div>
</div>

<div class="pgrouting drivers d-none">
    {{ form_row(form.configuration.connection) }}
    {{ form_row(form.configuration.pgWayTable) }}
    {{ form_row(form.configuration.pgWayTableVertices) }}
    <div class="advanced d-none">
        {{ form_row(form.configuration.pgWeighting) }}
        {{ form_row(form.configuration.pgSpeed) }}
        {{ form_row(form.configuration.pgInstructions) }}
    </div>
</div>

<div class="osrm drivers d-none">
    {{ form_row(form.configuration.osrmUrl) }}
    {{ form_row(form.configuration.osrmService) }}
    {{ form_row(form.configuration.osrmTransportationMode) }}
    <div class="advanced d-none">
        {{ form_row(form.configuration.osrmVersion) }}
        {{ form_row(form.configuration.osrmAlternatives) }}
        {{ form_row(form.configuration.osrmSteps) }}
        {{ form_row(form.configuration.osrmAnnotations) }}
        {{ form_row(form.configuration.osrmOverview) }}
        {{ form_row(form.configuration.osrmContinueStraight) }}
    </div>
</div>

<div class="trias drivers d-none">
    <p>Currently no driver configuration possible</p>
</div>

<div class="search d-none">
    <hr>
    <h3 class="my-4">Suche</h3>
    {{ form_row(form.configuration.search.searchDriver) }}
    {% if form.configuration.search.searchDriver is defined %}
        {% for searchTag in form.configuration.search %}
            {# form_label(searchTag) }}{{ form_widget(searchTag) #}
        {% endfor %}
        {{ form_row(form.configuration.search.searchUrl) }}
        <div class="advanced d-none">
            {{ form_row(form.configuration.search.query_key) }}
            {{ form_row(form.configuration.search.query_ws_replace) }}
            {{ form_row(form.configuration.search.query_format) }}
            {{ form_row(form.configuration.search.token_regex) }}
            {{ form_row(form.configuration.search.token_regex_in) }}
            {{ form_row(form.configuration.search.token_regex_out) }}
            {{ form_row(form.configuration.search.collection_path) }}
            {# !! The following values are not evaluated !! #}
            {{ form_row(form.configuration.search.label_attribute) }}
            {{ form_row(form.configuration.search.geom_attribute) }}
            {{ form_row(form.configuration.search.geom_proj) }}
            {{ form_row(form.configuration.search.geom_format) }}
            {{ form_row(form.configuration.search.result_buffer) }}
            {{ form_row(form.configuration.search.result_minscale) }}
            {{ form_row(form.configuration.search.result_maxscale) }}
            {{ form_row(form.configuration.search.result_icon_url) }}
            {{ form_row(form.configuration.search.result_icon_offset) }}
        </div>
    {% endif %}
</div>

<div class="reverseGeocoding d-none">
    <hr>
    <h3 class="my-4">Reverse Geocoding</h3>
    {{ form_row(form.configuration.reverse.revGeocodingDriver) }}
    {{ form_row(form.configuration.reverse.revGeoConnection) }}
    {{ form_row(form.configuration.reverse.revTableName) }}
    {{ form_row(form.configuration.reverse.revRowGeoWay) }}
    {{ form_row(form.configuration.reverse.revRowSearch) }}
    <div class="advanced d-none">
        {{ form_row(form.configuration.reverse.revSearchBuffer) }}
    </div>
</div>

<script>
    $(document).ready(function() {
        const advancedSettings = $('#form_configuration_advanced');
        const activateSearch = $('#form_configuration_addSearch');
        const activateReverseGeocoding = $('#form_configuration_addReverseGeocoding');
        const routingDriverSelection = $('#form_configuration_routingDriver');
        const selectedRoutingDriver = routingDriverSelection.find('option:selected').val() || false;

        if (advancedSettings.is(':checked')) {
            $('.advanced').removeClass('d-none');
        }

        if (activateSearch.is(':checked')) {
            $('.search').removeClass('d-none');
        }

        if (activateReverseGeocoding.is(':checked')) {
            $('.reverseGeocoding').removeClass('d-none');
        }

        if (selectedRoutingDriver) {
            $('.' + selectedRoutingDriver).removeClass('d-none');
        }

        advancedSettings.on('change', () => {
            $('.advanced').toggleClass('d-none');
        });

        activateSearch.on('change', () => {
            $('.search').toggleClass('d-none');
        });

        activateReverseGeocoding.on('change', () => {
            $('.reverseGeocoding').toggleClass('d-none');
        });

        routingDriverSelection.on('change', (e) => {
            $('.drivers').addClass('d-none');
            const selectedDriver = '.' + $(e.target).val();
            $(selectedDriver).removeClass('d-none');
        });
    });
</script>
